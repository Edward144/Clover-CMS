function sidebarcollapse(){if($(window).width()<768){var sidebar=$(".wrapper > .main > .sidebar");sidebar.hide().addClass("collapse-left"),setTimeout((function(){sidebar.show()}),70)}}function responsive_filemanager_callback(field_id){var url=$("#"+field_id).val().split(location.protocol+"//"+location.hostname+root_dir)[1];$("input[name='"+field_id+"']").val(url).trigger("change")}function notification(element,text,classes,time){var date=new Date,notificationId=btoa(date).split("=")[0];void 0!==element&&element.length||(element=$("notifications")),void 0===classes&&(classes="alert-dark"),void 0===text&&(text=""),void 0===time?time=3e4:time<1e3&&(time=1e3),element.append("<div class='notification alert "+classes+"' id='"+notificationId+"'><span class='notificationText'>"+text+"</span><div class='timerWrap'></div><div class='timerBar'></div></div>");var thisNotification=$("#"+notificationId),timerBar;thisNotification.find(".timerBar").first().animate({width:"100%"},time,(function(){thisNotification.animate({right:"-9999px"},1e3,(function(){thisNotification.remove()}))}))}function formbuilder_generaterandom(){var random;return btoa((new Date).getTime()).split("=")[0]}function formbuilder_save(output,builder="",debug=!1){var structure={};builder=""==builder?$(".formbuilder").first():builder,structure.formid=builder.children(".list-group").children(".actions").find("input[name='formid']").val(),structure.action=builder.children(".list-group").children(".actions").find("input[name='action']").val(),structure.method=builder.children(".list-group").children(".actions").find("select[name='method']").val();var groups=[],gi=0;builder.children(".list-group").children(".list-group-item:not(.actions)").each((function(){var inputs=[],ii=0;$(this).children(".inputs").children(".input").each((function(){var inputValues={};if($(this).find("input:not([type='button']):not([type='submit']), textarea, checkbox").each((function(){if(!$(this).parents(".list-group-item").first().hasClass("option")){var index=$(this).attr("name");if($(this).is(":checkbox"))if($(this).is(":checked"))var value=!0;else var value=!1;else var value=$(this).val();inputValues[index]=value}})),$(this).find(".options").length){var options=[];$(this).find(".option").each((function(){if($(this).find(":radio").length){if($(this).find(":radio:checked").length)var isDefault=!0;else var isDefault=!1;options.push({value:$(this).find("input[name='optionvalue']").first().val(),default:isDefault})}else options.push({value:$(this).find("input[name='optionvalue']").first().val()})})),inputValues.options=options}inputs[ii]=inputValues,ii++})),groups[gi]={groupid:$(this).find("input[name='groupid']").first().val(),name:$(this).find("input[name='groupname']").first().val(),inputs:inputs},gi++})),structure.groups=groups,!0===debug?console.log(structure):output.val(JSON.stringify(structure))}function formbuilder_addgroup(button){var groupCount=$(".formbuilder").children(".groups").children(".group").length+1,groupData={groupid:formbuilder_generaterandom(),name:"Group "+groupCount,inputs:[]};$.ajax({url:root_dir+"includes/classes/formbuilder.class.php",method:"post",dataType:"json",data:{id:$(this).parent(".structure").first().find("input[name='formid']").val(),data:JSON.stringify(groupData),formbuilder_method:"addGroup"},success:function(data){$(data).insertBefore(button.parents(".list-group-item").first()),formbuilder_disablesubmit(),formbuilder_sortable($(".groups"))}})}function formbuilder_addinput(button,input="",inputData={}){inputData.type=""==input?button.siblings("select[name='inputType']").val():input,inputData.inputid=formbuilder_generaterandom(),$.ajax({url:root_dir+"includes/classes/formbuilder.class.php",method:"post",dataType:"json",data:{id:$(this).parent(".structure").first().find("input[name='formid']").val(),data:JSON.stringify(inputData),formbuilder_method:"addInput"},success:function(data){$(data).insertBefore(button.parents(".list-group-item").first()),formbuilder_disablesubmit(),formbuilder_sortable($(".inputs"))}})}function formbuilder_addoption_select(button){$.ajax({url:root_dir+"includes/classes/formbuilder.class.php",method:"post",dataType:"json",data:{id:$(this).parent(".structure").first().find("input[name='formid']").val(),formbuilder_method:"addOptionSelect"},success:function(data){$(data).insertBefore(button.parents(".list-group-item").first())}})}function formbuilder_addoption_radio(button){var count=button.parents(".list-group").first().children(".list-group-item:not(.actions)").length,inputId=button.parents(".input").first().find("input[name='inputid']").first().val();if(count>0)var isDefault=!1;else var isDefault=!0;$.ajax({url:root_dir+"includes/classes/formbuilder.class.php",method:"post",dataType:"json",data:{id:$(this).parent(".structure").first().find("input[name='formid']").val(),inputId:inputId,isDefault:isDefault,formbuilder_method:"addOptionRadio"},success:function(data){$(data).insertBefore(button.parents(".list-group-item").first())}})}function formbuilder_deleteitem(button){var type=button.val().split("Ã— ")[1].toLowerCase(),parent=button.parents(".list-group").first(),isChecked=button.parent(".input-group").find("input[type='radio']:checked").length;confirm("Are you sure you want to delete this "+type+"?")&&(button.parents(".list-group-item").first().remove(),"option"==type&&isChecked>0&&parent.find("input[type='radio']").first().prop("checked",!0),formbuilder_disablesubmit())}function formbuilder_disablesubmit(){$(".formbuilder").find("input[name='type'][value='submit']").length?($(".formbuilder select[name='inputType']").children("option[value='input_submit']").prop("disabled",!0),$(".formbuilder select[name='inputType']").children("option").prop("selected",!1)):$(".formbuilder select[name='inputType']").children("option[value='input_submit']").prop("disabled",!1)}function formbuilder_sortable(element){element.sortable({cancel:".actions",items:".list-group-item:not(.actions)",containment:"parent",cancel:"input,textarea,select"})}function carousel_loadcontrols(carousel){carousel.find(".carousel-item:not(.additionalSlide)").each((function(){$(this).find(".carouselControls").length||($("<div class='carouselControls'><button type='button' class='btn btn-dark btnTop' name='carouselTextT' data-toggle='tooltip' data-placement='bottom' title='Text Align Top'><span class='fas fa-grip-lines'></span></button><button type='button' class='btn btn-dark' name='carouselTextM' data-toggle='tooltip' data-placement='bottom' title='Text Align Middle'><span class='fas fa-grip-lines'></span></button><button type='button' class='btn btn-dark btnBottom' name='carouselTextB' data-toggle='tooltip' data-placement='bottom' title='Text Align Bottom'><span class='fas fa-grip-lines'></span></button><button type='button' class='btn btn-dark' name='carouselTextL' data-toggle='tooltip' data-placement='bottom' title='Text Align Left'><span class='fas fa-align-left'></span></button><button type='button' class='btn btn-dark' name='carouselTextC' data-toggle='tooltip' data-placement='bottom' title='Text Align Center'><span class='fas fa-align-center'></span></button><button type='button' class='btn btn-dark' name='carouselTextR' data-toggle='tooltip' data-placement='bottom' title='Text Align Right'><span class='fas fa-align-right'></span></button><button type='button' class='btn btn-dark btnVertical' name='carouselTitleColor' data-toggle='tooltip' data-placement='bottom' title='Title Colour'><span class='fas fa-heading'></span><span class='fas fa-palette'></span></button><button type='button' class='btn btn-dark btnVertical' name='carouselTaglineColor' data-toggle='tooltip' data-placement='bottom' title='Tagline Colour'><span class='fas fa-paragraph'></span><span class='fas fa-palette'></span></button><button type='button' class='btn btn-dark' name='carouselImage' data-toggle='tooltip' data-placement='bottom' title='Choose Image'><span class='fas fa-image'></span></button><button type='button' class='btn btn-danger' name='carouselDelete' data-toggle='tooltip' data-placement='bottom' title='Delete Slide'><span class='fas fa-trash'></span></button></div>").prependTo($(this)),$("[data-toggle='tooltip']").tooltip()),carousel_checkimage($(this))}))}function carousel_save(carousel){var savelocation=$("input[name='carousel']");if(carousel.length&&savelocation.length){var json=[],i=0;carousel.find(".carousel-item:not(.additionalSlide)").each((function(){var image=$(this).find("img.background").attr("src"),title=$(this).find("input[name='carouselTitle']").val(),tagline=$(this).find("input[name='carouselTagline']").val(),titlecolor=$(this).find("input[name='carouselTitle']").css("color"),taglinecolor=$(this).find("input[name='carouselTagline']").css("color"),position=$(this).find("img.background").css("object-position"),textalign=$(this).find("input[name='carouselTitle']").css("text-align"),verticalalign=$(this).find(".carousel-item-inner").css("justify-content");json[i]={image:image,imageposition:position,title:title,titlecolor:titlecolor,tagline:tagline,taglinecolor:taglinecolor,textalign:textalign,verticalalign:verticalalign},i++})),savelocation.val(JSON.stringify(json))}else console.log("Err: Carousel cannot be saved")}function carousel_regen(carousel){var savelocation,carouseljson=$("input[name='carousel']").val();$.ajax({url:window.location.pathname,method:"post",dataType:"json",data:{carouselid:carousel.attr("id").split("carousel")[1],carouseldata:carouseljson,method:"carouselRegen"},success:function(data){carousel.html($(data).html()),carousel_loadcontrols(carousel),$("input[name='carousel']").length>1&&$("input[name='carousel']").last().remove(),carousel.carousel("dispose")}})}function carousel_addslide(carousel){var savelocation=$("input[name='carousel']");if(carousel.length){carousel_save(carousel,savelocation);var carouseljson=JSON.parse(savelocation.val()),carouselcount;carouseljson[carouseljson.length]={image:""},savelocation.val(JSON.stringify(carouseljson)),carousel_regen(carousel),$(document).ajaxComplete((function(){carousel.find(".carousel-item.active").removeClass("active"),carousel.find(".carousel-item:not(.additionalSlide)").length?carousel.find(".carousel-item:not(.additionalSlide)").last().addClass("active"):carousel.find(".carousel-item").last().addClass("active")}))}}function carousel_deleteslide(item){var savelocation=$("input[name='carousel']"),carousel=item.parents(".carousel").first();confirm("Are you sure you want to delete this slide?")&&(item.remove(),$(".tooltip").remove(),carousel_save(carousel,savelocation),carousel_regen(carousel))}function carousel_rf_callback(field_id){var url=$("#"+field_id).val().split(location.protocol+"//"+location.hostname+root_dir)[1];$("#img"+field_id).attr("src",url),$("#"+field_id).remove(),carousel_checkimage($("#img"+field_id).parents(".carousel-item").first())}function carousel_selectimage(item){var random=btoa(new Date).split("=")[0];item.find("img.background").remove(),item.prepend("<input type='hidden' id='"+random+"' name='"+random+"'>"),item.prepend("<img src='' class='background' id='img"+random+"'>"),$.fancybox.open({src:"js/responsive_filemanager/filemanager/dialog.php?type=1&field_id="+random+"&callback=carousel_rf_callback",type:"iframe"})}function carousel_textvertical(item,alignment){if(item.hasClass("carousel-item-inner"))switch(alignment){case"flex-start":case"center":case"flex-end":item.css("justify-content",alignment);break;case"centre":case"middle":item.css("justify-content","center");break;case"top":case"start":item.css("justify-content","flex-start");break;case"bottom":case"end":item.css("justify-content","flex-end");break;default:item.css("justify-content","")}}function carousel_textalign(item,alignment){switch(alignment){case"left":case"center":case"right":item.css("text-align",alignment);break;case"centre":case"middle":item.css("text-align","center");break;case"start":item.css("text-align","left");break;case"end":item.css("text-align","right");break;default:item.css("text-align","")}}function carousel_textcolor(item,color){for(var validrgb="([0-9]|[0-9][0-9]|[0-1][0-9][0-9]|2[0-4][0-9]|25[0-5])",alpha="([0-1]|0.[0-9]{1,2})",commas="(,|,\\s)",pattern="^rgb\\(",i=0;i<=2;i++)pattern+=validrgb,i<2&&(pattern+=commas);pattern+="\\)$";var rgbReg=new RegExp(pattern,"gi"),rgbaReg=new RegExp(pattern.replace(new RegExp("rgb","gi"),"rgba").replace("\\)$",commas+alpha+"\\)$"),"gi");/^\#([\da-fA-F]{3}){1,2}$/.test(color)?item.css("color",color):rgbReg.test(color)?item.css("color",color):rgbaReg.test(color)?item.css("color",color):CSS_COLORS.includes(color.toLowerCase())?item.css("color",color.toLowerCase()):item.css("color","")}$(".sidebar").on("click","#toggleSidebar",(function(){var sidebar=$(this).parents(".sidebar").first();sidebar.hasClass("collapse-left")?sidebar.removeClass("collapse-left"):sidebar.addClass("collapse-left")})),$(document).ready((function(){sidebarcollapse()})),$("form").submit((function(){var valid=!0,passChar=8;if($(this).find(".invalid-feedback").remove(),$(this).find(".is-invalid").removeClass("is-invalid"),$(this).find("input[name='password']").length&&$(this).find("input[name='passwordConf']").length){var pass=$(this).find("input[name='password']"),passConf=$(this).find("input[name='passwordConf']");(pass.val().length||passConf.val().length)&&(pass.val().length<8?(pass.addClass("is-invalid"),$("<div class='invalid-feedback'>Password must be at least 8 characters</div>").insertAfter(pass),valid=!1):/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])/.test(pass.val())?pass.val()!=passConf.val()&&(pass.addClass("is-invalid"),passConf.addClass("is-invalid"),$("<div class='invalid-feedback'>Passwords do not match</div>").insertAfter(passConf),valid=!1):(pass.addClass("is-invalid"),$("<div class='invalid-feedback'>Password must contain at least one lowercase, one uppercase and one digit</div>").insertAfter(pass),valid=!1))}if($(this).find("input[name='url']").length){var url=$(this).find("input[name='url']");/^[a-zA-Z0-9\:\/\-\_\+\?\&\=\#\.]+$/.test(url.val())||(url.addClass("is-invalid"),$("<div class='invalid-feedback'>Url contains invalid characters. Allowed characters are A-Z, 0-9, :, /, -, _, +, ?, &, =, #, .</div>").insertAfter(url),valid=!1)}!1!==valid||event.preventDefault()})),$("input[name='url']").keyup((function(){var url=$(this);url.removeClass("is-invalid"),url.siblings(".invalid-feedback").remove(),/^[a-zA-Z0-9\:\/\-\_\+\?\&\=\#\.]+$/.test(url.val())||(url.addClass("is-invalid"),$("<div class='invalid-feedback'>Url contains invalid characters. Allowed characters are A-Z, 0-9, :, /, -, _, +, ?, &, =, #, .</div>").insertAfter(url))})),$("input[type='submit'][data-confirm]").click((function(){confirm($(this).attr("data-confirm"))||event.preventDefault()})),$("input[name='clearSearch']").click((function(){window.location.href=window.location.href.split("?")[0]})),$("input[name='returnList']").click((function(){var queryString,queryItems=location.href.split("?")[1].split("&"),queryParameters=[];$.each(queryItems,(function(index,value){queryParameters[value.split("=")[0]]=value.split("=")[1]})),void 0!==queryParameters.return&&queryParameters.return.length?window.location.href=decodeURIComponent(queryParameters.return):window.location.href=window.location.href.split("?")[0]})),$("input[name='deleteContent'], input[name='deleteEvent']").click((function(){var btn=$(this);confirm("Are you sure you want to delete this content?")&&btn.attr("data-id").length&&$.ajax({url:window.location.pathname,method:"post",dataType:"json",data:{id:$(this).attr("data-id"),method:"deleteContent"},success:function(data){if("success"==data.status)location.reload();else{var message="<div class='alert alert-"+data.status+"'>"+data.message+"</div>";btn.parents("table").first().length>0?(btn.parents("table").first().find(".alert").remove(),$(message).insertBefore(btn.parents("table").first())):(btn.parents("form").first().find(".alert").remove(),$(message).appendTo(btn.parents("form").first()))}}})})),$(".countChars").keyup((function(){var limit=$(this).attr("maxlength"),chars=$(this).val().length;$(this).siblings("small.charCount").length?$(this).siblings("small.charCount").text(chars+" of "+limit):$("<small class='charCount d-block text-end'>"+chars+" of "+limit+"</small>").insertAfter($(this))})),$("#otherSettings").submit((function(){var valid=!0,analytics=$(this).find("input[name='googleAnalytics']");!analytics.val().length||/^[A-Z]{2}\-[0-9]{8}\-[0-9]$/.test(analytics.val())||/^[A-Z]{1}\-[A-Z0-9]{10}$/.test(analytics.val())||(analytics.addClass("is-invalid"),$("<div class='invalid-feedback'>Value does not appear to be valid</div>").insertAfter(analytics),valid=!1),!1!==valid||event.preventDefault()})),$("select[name='chooseMenu']").change((function(){window.location.href=window.location.href.split("manage-navigation/")[0]+"manage-navigation/"+$(this).val()})),$("#insertNavigation select[name='existing']").change((function(){var option=$(this).children(":selected"),name=option.attr("data-name"),url=option.attr("data-url");$("#insertNavigation").find("input[name='name']").val(name),$("#insertNavigation").find("input[name='url']").val(url)})),$(".structure").on("click","button[name='edit']",(function(){$(this).parents(".navigationLevel").first().find(".modal").first().modal("show")})),$(".navigationLevel .modal input,.navigationLevel .modal select").on("change",(function(){$(this).parents(".navigationLevel").first().addClass("pending")})),$(".structure").on("click","button[name='delete']",(function(){confirm("Are you sure you want to delete this item?")&&($(this).parents(".navigationLevel").first().find("input[name='delete']").first().val(1),$(this).parents(".navigationLevel").first().hide())})),$(".structureItems").sortable({items:".navigationLevel",connectWith:".structureItems",dropOnEmpty:!0,stop:function(){$(".structure .navigationLevel").each((function(){var position=$(this).prevAll(".navigationLevel").length,edit=$(this).find(".modal").first();if($(this).parent().is(".structure"))var parent=0;else var parent=$(this).parents(".navigationLevel").first().attr("data-id");edit.find("input[name='parent']").val(parent),edit.find("input[name='position']").val(position)}))}}),$(".structure input[name='saveStructure']").click((function(){var json={},btn=$(this),structure=$(this).parents(".structure").first(),i=0;if(structure.find(".alert").remove(),structure.find(".navigationLevel").each((function(){var form=$(this).children(".modal").first();json[i]={id:form.find("input[name='id']").val(),name:form.find("input[name='name']").val(),url:form.find("input[name='url']").val(),visible:form.find("select[name='visible']").val(),parent:form.find("input[name='parent']").val(),position:form.find("input[name='position']").val(),delete:form.find("input[name='delete']").val()},i++})),structure.find(".is-invalid").length||structure.find(".invalid-feedback").length)return event.preventDefault(),void $("<div class='alert alert-danger mt-3'>You have entered invalid information. Please check your inputs and try again.</div>").insertAfter(btn.parent(".form-group"));structure.find("input[name='json']").val(JSON.stringify(json))})),$("#manageForm").submit((function(){formbuilder_save($(this).find("input[name='structure']"))})),$(".formbuilder").on("click","input[name='addGroup']",(function(){formbuilder_addgroup($(this))})),$(".formbuilder").on("click","input[name='addInput']",(function(){formbuilder_addinput($(this))})),$(".formbuilder").on("click","input[name='addOptionSelect']",(function(){formbuilder_addoption_select($(this))})),$(".formbuilder").on("click","input[name='addOptionRadio']",(function(){formbuilder_addoption_radio($(this))})),$(".formbuilder").on("click","input[name='deleteGroup'], input[name='deleteInput'], input[name='deleteOption']",(function(){formbuilder_deleteitem($(this))})),$(document).ready((function(){formbuilder_disablesubmit(),formbuilder_sortable($(".groups")),formbuilder_sortable($(".inputs"))})),$(".formbuilder").on("click","input[name='expander']",(function(){"Expand"==$(this).val()?$(this).val("Collapse"):$(this).val("Expand")})),$("input[name='deleteForm']").click((function(){var id=$(this).attr("data-id");$(".contentInner").find(".alert").remove(),confirm("Are you sure you want to delete this form?")&&$.ajax({url:window.location.href,method:"post",dataType:"json",data:{id:id,deleteForm:!0},success:function(data){"success"==data.status?window.location.reload():$("<div class='alert alert-"+data.status+" mt-3'>"+data.deletemsg+"</div>").appendTo($(".contentInner > div:first-child"))}})})),$(".deleteRole").submit((function(){confirm("Are you sure you want to delete this role? All users set to this role will be changed to Standard users.")||event.preventDefault()})),$("input[name='deleteComment']").click((function(){var btn=$(this);confirm("Are you sure you want to delete this comment? Any replies will also be hidden.")&&btn.attr("data-id").length&&$.ajax({url:window.location.pathname,method:"post",dataType:"json",data:{id:$(this).attr("data-id"),method:"deleteComment"},success:function(data){if("success"==data.status)location.reload();else{var message="<div class='alert alert-"+data.status+"'>"+data.message+"</div>";btn.parents("table").first().length>0?(btn.parents("table").first().find(".alert").remove(),$(message).insertBefore(btn.parents("table").first())):(btn.parents("form").first().find(".alert").remove(),$(message).appendTo(btn.parents("form").first()))}}})})),$("input[name='modifyComment']").click((function(){$(this).parents("table").first().find(".alert").remove();var btn=$(this),id=btn.attr("data-id"),comment=btn.parents("tr").first().find("textarea[name='comment']").val();if(btn.siblings(".form-check").children("input[name='approved']").is(":checked"))var approved=1;else var approved=0;btn.attr("data-id").length&&$.ajax({url:window.location.pathname,method:"post",dataType:"json",data:{id:id,approved:approved,comment:comment,method:"modifyComment"},success:function(data){if("success"==data.status)location.reload();else{var message="<div class='alert alert-"+data.status+"'>"+data.message+"</div>";btn.parents("table").first().length>0?(btn.parents("table").first().find(".alert").remove(),$(message).insertBefore(btn.parents("table").first())):(btn.parents("form").first().find(".alert").remove(),$(message).appendTo(btn.parents("form").first()))}}})})),$(document).ready((function(){$(".carousel.builder").length&&carousel_loadcontrols($(".carousel.builder"))})),$("#manageContent").submit((function(){$(this).find(".carousel.builder").length&&carousel_save($(this).find(".carousel.builder"))})),$("body").on("click","button[name='addCarousel']",(function(){var carousel;carousel_addslide($(this).parents(".carousel").first())})),$("body").on("click","button[name='carouselDelete']",(function(){carousel_deleteslide($(this).parents(".carousel-item").first())})),$("body").on("click","button[name='carouselImage']",(function(){carousel_selectimage($(this).parent(".carouselControls").siblings(".carousel-item-inner").first())})),$(".carousel.builder").on("click","button[name='carouselTextT'],button[name='carouselTextM'],button[name='carouselTextB']",(function(){var position=$(this).attr("name").split("carouselText")[1],inner=$(this).parents(".carousel-item").find(".carousel-item-inner").first();switch(position){case"T":carousel_textvertical(inner,"flex-start");break;case"M":carousel_textvertical(inner,"center");break;case"B":carousel_textvertical(inner,"flex-end")}})),$(".carousel.builder").on("click","button[name='carouselTextL'],button[name='carouselTextC'],button[name='carouselTextR']",(function(){var position=$(this).attr("name").split("carouselText")[1],title=$(this).parents(".carousel-item").find("input[name='carouselTitle']").first(),tagline=$(this).parents(".carousel-item").find("input[name='carouselTagline']").first();switch(position){case"L":carousel_textalign(title,"left"),carousel_textalign(tagline,"left");break;case"C":carousel_textalign(title,"center"),carousel_textalign(tagline,"center");break;case"R":carousel_textalign(title,"right"),carousel_textalign(tagline,"right");break;default:carousel_textalign(title,""),carousel_textalign(tagline,"")}}));var carousel_textcolour=carousel_textcolor;function componentToHex(c){var hex=c.toString(16);return 1==hex.length?"0"+hex:hex}function rgbToHex(r,g,b){return"#"+componentToHex(r)+componentToHex(g)+componentToHex(b)}function carousel_checkimage(item){var image=item.find("img.background");image.length&&image.attr("src").length&&!item.find(".carouselControls button[name='carouselImageH']").length&&!item.find(".carouselControls button[name='carouselImageV']").length&&$("<button type='button' class='btn btn-dark' name='carouselImageH' data-toggle='tooltip' data-placement='bottom' title='Image Horizontal'><span class='fas fa-arrows-alt-h'></span></button><button type='button' class='btn btn-dark' name='carouselImageV' data-toggle='tooltip' data-placement='bottom' title='Image Vertical'><span class='fas fa-arrows-alt-v'></span></button>").insertBefore(item.find(".carouselControls button[name='carouselDelete']"))}function carousel_imageposition(item,horizontal,vertical){var objectPosition=item.css("object-position"),currentHorz=objectPosition.split(" ")[0].trim(),currentVert=objectPosition.split(" ")[1].trim(),newPosition="";""==horizontal&&""==vertical?item.css("object-position",""):(/^(\-?)[\d]+(px|pt|em|rem|\%){1}$/.test(horizontal)||(horizontal=currentHorz),/^(\-?)[\d]+(px|pt|em|rem|\%){1}$/.test(vertical)||(vertical=currentVert),newPosition=horizontal+" "+vertical,item.css("object-position",newPosition))}$(".carousel.builder").on("click","button[name='carouselTitleColor'],button[name='carouselTaglineColor']",(function(){var btn=$(this),type="",currColor="";if("TitleColor"==$(this).attr("name").split("carousel")[1]?(type="Title",currColor=$(this).parents(".carousel-item").first().find("input[name='carouselTitle']").css("color")):"TaglineColor"==$(this).attr("name").split("carousel")[1]&&(type="Tagline",currColor=$(this).parents(".carousel-item").first().find("input[name='carouselTagline']").css("color")),currColor.indexOf("rgb")>=0||currColor.indexOf("rgba")>=0){var colors=currColor.replace(new RegExp(/\s/,"g"),"").match(/[0-9]{0,3}/g),i=1,r,g,b;$.each(colors,(function(key,color){if(color.length&&i<=3){switch(i){case 1:r=color;break;case 2:g=color;break;case 3:b=color}i++}})),r.length&&g.length&&b.length&&(currColor=rgbToHex(parseInt(r),parseInt(g),parseInt(b)))}$(this).next(".carouselPicker").length?($(this).removeClass("hasInput"),$(this).next(".carouselPicker").remove()):($(this).addClass("hasInput"),$("<div class='carouselPicker'><input type='color' class='form-control form-control-color p-0' colorformat='rgb' name='carouselPicker"+type+"' data-color='"+currColor+"' value='"+currColor+"'></div>").insertAfter($(this)))})),$(".carousel.builder").on("change","input[type='color']",(function(){carousel_textcolor($(this).parents(".carousel-item").first().find("input[name='carousel"+$(this).attr("name").split("carouselPicker")[1]+"']"),$(this).val())})),$(".carousel.builder").on("click","button[name='carouselImageH'],button[name='carouselImageV']",(function(){var objectPosition=$(this).parents(".carousel-item").first().find("img.background").css("object-position"),imageValue="",type=$(this).attr("name").split("carouselImage")[1];"H"==type?(imageValue=objectPosition.split(" ")[0],type="Horizontal"):"V"==type&&(imageValue=objectPosition.split(" ")[1],type="Vertical"),$(this).next(".carouselInput").length?($(this).removeClass("hasInput"),$(this).next(".carouselInput").remove()):($(this).addClass("hasInput"),$("<div class='carouselInput'><input type='text' class='form-control py-0 px-1' name='carouselImage"+type+"' placeholder='px, pt, em, rem, %' value='"+imageValue+"'></div>").insertAfter($(this)))})),$(".carousel.builder").on("keyup","input[name='carouselImageHorizontal'],input[name='carouselImageVertical']",(function(){var horz="",vert="",controls=$(this).parents(".carouselControls").first();"Horizontal"==$(this).attr("name").split("carouselImage")[1]?(horz=$(this).val(),vert=controls.find("input[name='carouselImageVertical']").length?controls.find("input[name='carouselImageVertical']").val():""):"Vertical"==$(this).attr("name").split("carouselImage")[1]&&(horz=controls.find("input[name='carouselImageHorizontal']").length?controls.find("input[name='carouselImageHorizontal']").val():"",vert=$(this).val()),horz=horz.length?horz:"50%",vert=vert.length?vert:"50%",carousel_imageposition($(this).parents(".carousel-item").first().find("img.background"),horz,vert)})),$(document).keydown((function(e){if($(".carousel.builder input[name='carouselImageHorizontal'],.carousel.builder input[name='carouselImageVertical']").is(":focus")){var input=$(":focus");if(/^(\-?)[\d]+(px|pt|em|rem|\%){1}$/.test(input.val())){var inputnumber=parseInt(input.val()),inputsuffix=input.val().split(inputnumber)[1];switch(e.which){case 38:inputnumber+=1,input.val(inputnumber+inputsuffix);break;case 40:inputnumber-=1,input.val(inputnumber+inputsuffix)}}}}));