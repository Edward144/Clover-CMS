function sticky(t){var e=t.outerHeight(),a=t.offset().top;$(window).scrollTop()>e+a?t.addClass("sticky"):0==$(window).scrollTop()&&t.removeClass("sticky"),"pageHeader"==t.attr("id")&&t.siblings(".main")&&t.hasClass("sticky")?t.siblings(".main").first().css({"margin-top":e}):t.siblings(".main").first().css({"margin-top":""})}function comments_load(t,e){if(0==e)var a=$(".comments > .comment").last(),i=$(".comments > .comment").length;else a=$("#comment"+e+" > .comment").last(),i=$("#comment"+e+" > .comment").length;$.ajax({url:"includes/classes/comments.class.php",method:"post",dataType:"html",data:{loadcomments:!0,contentid:t,parent:e,offset:i},success:function(t){$(t).insertAfter(a)},error:function(t,e,a){console.log(a)}})}$(".navbar .dropdown-toggle").click(function(){$(this).parent(".nav-item").toggleClass("exp")}),$(window).scroll(function(){sticky($("#pageHeader"))}),$(document).ready(function(){sticky($("#pageHeader"))}),$("form").submit(function(){var t=!0;if($(this).find(".invalid-feedback").remove(),$(this).find(".is-invalid").removeClass("is-invalid"),$(this).find("input[name='password']").length&&$(this).find("input[name='passwordConf']").length){var e=$(this).find("input[name='password']"),a=$(this).find("input[name='passwordConf']");(e.val().length||a.val().length)&&(e.val().length<8?(e.addClass("is-invalid"),$("<div class='invalid-feedback'>Password must be at least 8 characters</div>").insertAfter(e),t=!1):/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])/.test(e.val())?e.val()!=a.val()&&(e.addClass("is-invalid"),a.addClass("is-invalid"),$("<div class='invalid-feedback'>Passwords do not match</div>").insertAfter(a),t=!1):(e.addClass("is-invalid"),$("<div class='invalid-feedback'>Password must contain at least one lowercase, one uppercase and one digit</div>").insertAfter(e),t=!1))}if($(this).find("input[name='url']").length){var i=$(this).find("input[name='url']");/^[a-zA-Z0-9\:\/\-\_\+\?\&\=\#\.]+$/.test(i.val())||(i.addClass("is-invalid"),$("<div class='invalid-feedback'>Url contains invalid characters. Allowed characters are A-Z, 0-9, :, /, -, _, +, ?, &, =, #, .</div>").insertAfter(i),t=!1)}0!=t||event.preventDefault()});var recaptchaWidgets=[];function comments_loadcaptcha(t){var e=t.attr("id");t.html().length||(recaptchaWidgets[e.split("recaptcha")[1]]=grecaptcha.render(e,{sitekey:recaptchaSitekey}))}var recaptchaOnload=function(){var t=$("#recaptcha0"),e=t.attr("id");t.html().length||(recaptchaWidgets[e.split("recaptcha")[1]]=grecaptcha.render(e,{sitekey:recaptchaSitekey}))};function comments_verifycaptcha(t){var e=t.find(".recaptcha"),a=[];e.length>0&&(event.preventDefault(),t.find(".alert").remove(),$.each(e,function(){var t=grecaptcha.getResponse(recaptchaWidgets[$(this).attr("id").split("recaptcha")[1]]);a.push(t)}),$.ajax({url:root_dir+"includes/actions/verifycaptcha.php",method:"post",dataType:"json",data:{responses:JSON.stringify(a),recaptchaverify:!0},success:function(a){if(0==a.valid)return $.each(e,function(){grecaptcha.reset(recaptchaWidgets[$(this).attr("id").split("recaptcha")[1]])}),$("<div class='mt-3 mb-0 py-2 alert alert-"+a.status+"'>"+a.message+"</div>").insertAfter($("form").find(":submit").parents(".form-group").first()),event.preventDefault(),!1;t.unbind("submit").submit()}}))}$(".postComment").submit(function(){comments_verifycaptcha($(this))}),$(".comments").on("click","a.commentReply",function(){if("true"==$(this).attr("aria-expanded")){var t=$(this).parents("h6").first().siblings(".commentForm").find(".recaptcha");$.each(t,function(){comments_loadcaptcha($(this))})}}),$("#manageaccount #togglePassword").click(function(){"true"===$(this).attr("aria-expanded")?($(this).text("Cancel Password Update"),$("#updatePassword").find("input[type='password']").val("")):$(this).text("Update Password")}),$(".commentEdit").click(function(){event.preventDefault();var t=$(this).parents(".comment").first(),e=t.children(".commentBody").first(),a=a=e.text();"Edit"==$(this).text()?($(this).text("Cancel Edit"),$("<a href='#' class='commentUpdate me-3'>Save edit</a>").insertAfter($(this)),e.html("<form class='editComment' action='includes/actions/editcomment' method='post'><input type='hidden' name='id' value='"+t.attr("id").split("comment")[1]+"'><input type='hidden' name='editComment'><input type='hidden' name='returnurl' value='"+window.location.href.split("#")[0]+"'><textarea class='form-control' name='comment' required>"+a+"</textarea></form>")):($(this).text("Edit"),$(this).siblings(".commentUpdate").remove(),e.html(a))}),$(".comment").on("click",".commentUpdate",function(){event.preventDefault();var t=$(this).parents(".comment").first().find(".editComment").first();""!=t.find("textarea[name='comment']").val()&&t.submit()});